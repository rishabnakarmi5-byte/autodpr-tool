<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construction DPR Maker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }
      /* Print styles */
      @media print {
        @page { size: A4; margin: 0; }
        body * { visibility: hidden; }
        #printable-report, #printable-report * { visibility: visible; }
        #printable-report { 
          position: absolute; 
          left: 0; 
          top: 0; 
          width: 100%; 
          margin: 0; 
          padding: 20mm !important; 
          box-shadow: none !important; 
          border: none !important;
        }
        .no-print { display: none !important; }
      }
      /* Loading Screen */
      #loading-indicator {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        background: #f1f5f9; z-index: 0;
      }
      .spinner {
        width: 40px; height: 40px; border: 4px solid #cbd5e1; border-top: 4px solid #4f46e5; border-radius: 50%;
        animation: spin 1s linear infinite; margin-bottom: 16px;
      }
      @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
    <script>
      // RESOURCE ERROR LISTENER (Catches 404s on scripts)
      window.addEventListener('error', function(e) {
        if (e.target && (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK')) {
             var loader = document.getElementById('loading-indicator');
             if(loader) {
                loader.innerHTML = '<div style="color:red; text-align:center; padding:20px;">' +
                  '<strong>Resource Load Error</strong><br/>' +
                  'Failed to load: ' + (e.target.src || e.target.href) + '<br/>' +
                  'Please check your internet connection or deployment configuration.' +
                  '</div>';
             }
        }
      }, true);

      // RUNTIME ERROR HANDLER
      window.onerror = function(message, source, lineno, colno, error) {
        var loader = document.getElementById('loading-indicator');
        if(loader) loader.style.display = 'none';

        var errorContainer = document.getElementById('debug-error-display');
        if(!errorContainer) {
             errorContainer = document.createElement('div');
             errorContainer.id = 'debug-error-display';
             errorContainer.style.position = 'fixed';
             errorContainer.style.top = '0';
             errorContainer.style.left = '0';
             errorContainer.style.width = '100%';
             errorContainer.style.background = '#fee2e2';
             errorContainer.style.color = '#991b1b';
             errorContainer.style.padding = '20px';
             errorContainer.style.zIndex = '99999';
             errorContainer.style.fontFamily = 'monospace';
             errorContainer.style.fontSize = '12px';
             errorContainer.style.borderBottom = '2px solid #b91c1c';
             errorContainer.style.whiteSpace = 'pre-wrap';
             document.body.appendChild(errorContainer);
        }
        errorContainer.textContent += 'RUNTIME ERROR: ' + message + '\nAt: ' + source + ':' + lineno + '\n\n';
      };
    </script>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "firebase/": "https://esm.sh/firebase@^12.7.0/",
    "@google/genai": "https://esm.sh/@google/genai@^1.35.0",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
</head>
<body class="bg-slate-100">
    <div id="loading-indicator">
       <div class="spinner"></div>
       <div class="text-slate-500 font-sans font-medium">Loading Construction DPR Maker...</div>
    </div>
    <div id="root" style="position: relative; z-index: 1;"></div>
    <script type="module" src="/index.tsx"></script>
</body>
</html>